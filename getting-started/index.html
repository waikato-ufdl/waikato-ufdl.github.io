<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Getting started | User-friendly Deep Learning</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://ufdl.cms.waikato.ac.nz/getting-started/">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><meta name="author" content="University of Waikato">
<meta property="og:site_name" content="User-friendly Deep Learning">
<meta property="og:title" content="Getting started">
<meta property="og:url" content="https://ufdl.cms.waikato.ac.nz/getting-started/">
<meta property="og:description" content="Contents

Docker-Compose / Docker

Docker-Compose
Docker

PostgreSQL
Redis
Backend


Initialize
Worker node


Manual setup

PostgreSQL
Backend
HTML front-end (optional)
Initialize
Worker node


Use th">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-09-15T15:23:32+12:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../">

            <span id="blog-title">User-friendly Deep Learning</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../news/" class="nav-link">News</a>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>
            <div class="dropdown-menu">
                    <a href="../architecture/" class="dropdown-item">Architecture</a>
                    <a href="." class="dropdown-item active">Getting started <span class="sr-only">(active)</span></a>
                    <a href="https://waikato-ufdl.github.io/ufdl-api/" class="dropdown-item">REST API</a>
            </div>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Code</a>
            <div class="dropdown-menu">
                    <a href="https://github.com/waikato-ufdl/" class="dropdown-item">Project</a>
                    <a href="https://github.com/waikato-ufdl/simple-django-teams" class="dropdown-item">simple-django-teams</a>
                    <a href="https://github.com/waikato-ufdl/wai-annotations" class="dropdown-item">wai.annotations</a>
                    <a href="https://github.com/waikato-ufdl/ufdl-backend" class="dropdown-item">ufdl-backend</a>
                    <a href="https://github.com/waikato-ufdl/ufdl-json-messages" class="dropdown-item">ufdl-json-messages</a>
                    <a href="https://github.com/waikato-ufdl/ufdl-python-client" class="dropdown-item">ufdl-python-client</a>
                    <a href="https://github.com/waikato-ufdl/ufdl-java-client" class="dropdown-item">ufdl-java-client</a>
                    <a href="https://github.com/waikato-ufdl/ufdl-frontend-adams" class="dropdown-item">ufdl-frontend-adams</a>
                    <a href="https://github.com/waikato-ufdl/ufdl-job-launcher" class="dropdown-item">ufdl-job-launcher</a>
                    <a href="https://github.com/waikato-ufdl/ufdl-job-launcher-plugins" class="dropdown-item">ufdl-job-launcher-plugins</a>
                    <a href="https://github.com/waikato-ufdl/wai-lazypip" class="dropdown-item">wai.lazypip</a>
                    <a href="https://github.com/waikato-datamining/tensorflow/tree/master/tfutils" class="dropdown-item">wai.tfutils</a>
            </div>
            </li>
<li class="nav-item dropdown">
<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Docker</a>
            <div class="dropdown-menu">
                    <a href="https://aml-repo.cms.waikato.ac.nz/" class="dropdown-item">Registry</a>
                    <a href="https://github.com/waikato-datamining/mmdetection" class="dropdown-item">MMDetection</a>
                    <a href="https://github.com/waikato-datamining/pytorch/tree/master/crnn-audio-classification" class="dropdown-item">Pytorch CRNN Audio Classification</a>
                    <a href="https://github.com/waikato-datamining/pytorch/tree/master/deepspeech2" class="dropdown-item">Pytorch Deepspeech2</a>
                    <a href="https://github.com/waikato-datamining/pytorch/tree/master/detectron2" class="dropdown-item">Pytorch Detectron2</a>
                    <a href="https://github.com/waikato-datamining/pytorch/tree/master/image-classification" class="dropdown-item">Pytorch Image Classification</a>
                    <a href="https://github.com/waikato-datamining/pytorch/tree/master/yolov5" class="dropdown-item">Pytorch Yolov5</a>
                    <a href="https://github.com/waikato-datamining/tensorflow/tree/master/deepspeech" class="dropdown-item">Tensorflow DeepSpeech</a>
                    <a href="https://github.com/waikato-datamining/tensorflow/tree/master/image_classification" class="dropdown-item">Tensorflow Image Classification</a>
                    <a href="https://github.com/waikato-datamining/tensorflow/tree/master/image-segmentation-keras" class="dropdown-item">Tensorflow Image Segmentation</a>
                    <a href="https://github.com/waikato-datamining/tensorflow/tree/master/object_detection" class="dropdown-item">Tensorflow Object Detection</a>
                    <a href="https://github.com/waikato-datamining/yolact" class="dropdown-item">YOLACT</a>
            </div>
                </li>
<li class="nav-item">
<a href="../publications/" class="nav-link">Publications</a>
                </li>
<li class="nav-item">
<a href="https://datasets.cms.waikato.ac.nz/ufdl/" class="nav-link">Datasets</a>
                </li>
<li class="nav-item">
<a href="../people/" class="nav-link">People</a>
                </li>
<li class="nav-item">
<a href="../rss.xml" class="nav-link">RSS</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Getting started</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <nav class="contents" id="contents" role="doc-toc"><p class="topic-title">Contents</p>
<ul class="simple">
<li>
<p><a class="reference internal" href="#docker-compose-docker" id="toc-entry-1">Docker-Compose / Docker</a></p>
<ul>
<li><p><a class="reference internal" href="#docker-compose" id="toc-entry-2">Docker-Compose</a></p></li>
<li>
<p><a class="reference internal" href="#docker" id="toc-entry-3">Docker</a></p>
<ul>
<li><p><a class="reference internal" href="#postgresql" id="toc-entry-4">PostgreSQL</a></p></li>
<li><p><a class="reference internal" href="#redis" id="toc-entry-5">Redis</a></p></li>
<li><p><a class="reference internal" href="#backend" id="toc-entry-6">Backend</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#initialize" id="toc-entry-7">Initialize</a></p></li>
<li><p><a class="reference internal" href="#worker-node" id="toc-entry-8">Worker node</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="#manual-setup" id="toc-entry-9">Manual setup</a></p>
<ul>
<li><p><a class="reference internal" href="#postgresql-1" id="toc-entry-10">PostgreSQL</a></p></li>
<li><p><a class="reference internal" href="#backend-1" id="toc-entry-11">Backend</a></p></li>
<li><p><a class="reference internal" href="#html-front-end-optional" id="toc-entry-12">HTML front-end (optional)</a></p></li>
<li><p><a class="reference internal" href="#initialize-1" id="toc-entry-13">Initialize</a></p></li>
<li><p><a class="reference internal" href="#worker-node-1" id="toc-entry-14">Worker node</a></p></li>
</ul>
</li>
<li>
<p><a class="reference internal" href="#use-the-system" id="toc-entry-15">Use the system</a></p>
<ul>
<li><p><a class="reference internal" href="#adams" id="toc-entry-16">ADAMS</a></p></li>
<li><p><a class="reference internal" href="#html-frontend" id="toc-entry-17">HTML Frontend</a></p></li>
</ul>
</li>
</ul></nav><p>At the time of writing, the overall system is not yet production-ready. However, if you want to check out
what the system is about, you can follow these instructions to set up a local development system that runs
on your own infrastructure. Of course, for most deep learning training or prediction tasks you will
require a NVIDIA GPU.</p>
<p>The server backend and worker nodes are expected to run Linux (tested with Ubuntu 18.04). The frontend,
e.g., when using ADAMS can be Linux, Windows or Mac. The HTML frontend has been tested with Chrome/Chromium and Firefox.</p>
<p>You can either use pre-configured Docker images or set up the system manually. See the respective section below
for relevant instructions.</p>
<section id="docker-compose-docker"><h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink">Docker-Compose / Docker</a></h2>
<p>When using any of the public UFDL images, make sure to be logged into our registry:</p>
<pre class="code bash"><a id="rest_code_6a29373e9c04471783a759d2bfe4d64e-1" name="rest_code_6a29373e9c04471783a759d2bfe4d64e-1" href="#rest_code_6a29373e9c04471783a759d2bfe4d64e-1"></a>docker login public.aml-repo.cms.waikato.ac.nz:443
</pre>
<section id="docker-compose"><h3><a class="toc-backref" href="#toc-entry-2" role="doc-backlink">Docker-Compose</a></h3>
<p>The <code class="docutils literal"><span class="pre">docker-compose</span></code> script combines the three steps from the Docker section: <strong>PostgreSQL</strong>, <strong>Redis</strong>, <strong>Backend</strong>.
To get started with <code class="docutils literal"><span class="pre">docker-compose</span></code>, first clone the backend repo:</p>
<pre class="code bash"><a id="rest_code_4b7122649981404c82f422d7e47e4324-1" name="rest_code_4b7122649981404c82f422d7e47e4324-1" href="#rest_code_4b7122649981404c82f422d7e47e4324-1"></a>git clone https://github.com/waikato-ufdl/ufdl-backend
<a id="rest_code_4b7122649981404c82f422d7e47e4324-2" name="rest_code_4b7122649981404c82f422d7e47e4324-2" href="#rest_code_4b7122649981404c82f422d7e47e4324-2"></a><span class="nb">cd</span> ufdl-backend/docker/ufdl
</pre>
<p>Pull the latest images for the services:</p>
<pre class="code bash"><a id="rest_code_a9a86704cfc6472390753d680dccdfb5-1" name="rest_code_a9a86704cfc6472390753d680dccdfb5-1" href="#rest_code_a9a86704cfc6472390753d680dccdfb5-1"></a>docker-compose pull
</pre>
<p>The <strong>first time</strong> running the system, the database will need to be initialised with the requisite tables:</p>
<pre class="code bash"><a id="rest_code_dba502769d724d078a2efe8d1f5af1ce-1" name="rest_code_dba502769d724d078a2efe8d1f5af1ce-1" href="#rest_code_dba502769d724d078a2efe8d1f5af1ce-1"></a>docker-compose run ufdl reset
</pre>
<p>On-line the backend with the <code class="docutils literal">up</code> command:</p>
<pre class="code bash"><a id="rest_code_f3e0a1c6de1e46be981d7973a9d74c87-1" name="rest_code_f3e0a1c6de1e46be981d7973a9d74c87-1" href="#rest_code_f3e0a1c6de1e46be981d7973a9d74c87-1"></a>docker-compose up
</pre></section><section id="docker"><h3><a class="toc-backref" href="#toc-entry-3" role="doc-backlink">Docker</a></h3>
<p>Instead of using <code class="docutils literal"><span class="pre">docker-compose</span></code>, you can also execute the individual steps for setting up the backend.</p>
<section id="postgresql"><h4><a class="toc-backref" href="#toc-entry-4" role="doc-backlink">PostgreSQL</a></h4>
<p>A Docker image which has a preconfigured PostgreSQL database is provided for convenience. To obtain the image, with
the Docker daemon running:</p>
<pre class="code bash"><a id="rest_code_77fdfba7f0fe454f8ce6a5058d0a2295-1" name="rest_code_77fdfba7f0fe454f8ce6a5058d0a2295-1" href="#rest_code_77fdfba7f0fe454f8ce6a5058d0a2295-1"></a>docker pull public.aml-repo.cms.waikato.ac.nz:443/ufdl/ufdl_postgres:latest
<a id="rest_code_77fdfba7f0fe454f8ce6a5058d0a2295-2" name="rest_code_77fdfba7f0fe454f8ce6a5058d0a2295-2" href="#rest_code_77fdfba7f0fe454f8ce6a5058d0a2295-2"></a>docker tag public.aml-repo.cms.waikato.ac.nz:443/ufdl/ufdl_postgres:latest ufdl_postgres
</pre>
<p>The username/password for the database user in this image is ufdl/ufdl respectively.</p>
<p>Alternatively, the Dockerfile can be built to change the username/password. Firstly clone the backend repository and
change to the database Docker directory:</p>
<pre class="code bash"><a id="rest_code_3449b8552cc24e3495ed0dd8ce60e00b-1" name="rest_code_3449b8552cc24e3495ed0dd8ce60e00b-1" href="#rest_code_3449b8552cc24e3495ed0dd8ce60e00b-1"></a>git clone https://github.com/waikato-ufdl/ufdl-backend
<a id="rest_code_3449b8552cc24e3495ed0dd8ce60e00b-2" name="rest_code_3449b8552cc24e3495ed0dd8ce60e00b-2" href="#rest_code_3449b8552cc24e3495ed0dd8ce60e00b-2"></a><span class="nb">cd</span> ufdl-backend/docker/database
</pre>
<p>Then build the Dockerfile with custom username/password settings:</p>
<pre class="code bash"><a id="rest_code_45e2f22063a0487e8868815f6ca4bc98-1" name="rest_code_45e2f22063a0487e8868815f6ca4bc98-1" href="#rest_code_45e2f22063a0487e8868815f6ca4bc98-1"></a>docker build <span class="se">\</span>
<a id="rest_code_45e2f22063a0487e8868815f6ca4bc98-2" name="rest_code_45e2f22063a0487e8868815f6ca4bc98-2" href="#rest_code_45e2f22063a0487e8868815f6ca4bc98-2"></a>  -t ufdl_postgres <span class="se">\</span>
<a id="rest_code_45e2f22063a0487e8868815f6ca4bc98-3" name="rest_code_45e2f22063a0487e8868815f6ca4bc98-3" href="#rest_code_45e2f22063a0487e8868815f6ca4bc98-3"></a>  --build-arg <span class="nv">UFDL_POSTGRESQL_USER</span><span class="o">=</span>username <span class="se">\</span>
<a id="rest_code_45e2f22063a0487e8868815f6ca4bc98-4" name="rest_code_45e2f22063a0487e8868815f6ca4bc98-4" href="#rest_code_45e2f22063a0487e8868815f6ca4bc98-4"></a>  --build-arg <span class="nv">UFDL_POSTGRESQL_PASSWORD</span><span class="o">=</span>password <span class="se">\</span>
<a id="rest_code_45e2f22063a0487e8868815f6ca4bc98-5" name="rest_code_45e2f22063a0487e8868815f6ca4bc98-5" href="#rest_code_45e2f22063a0487e8868815f6ca4bc98-5"></a>  .
</pre>
<p>So that database data will persist between executions, create a volume for storage:</p>
<pre class="code bash"><a id="rest_code_29db1dec48ce4188bf833e592bcbe370-1" name="rest_code_29db1dec48ce4188bf833e592bcbe370-1" href="#rest_code_29db1dec48ce4188bf833e592bcbe370-1"></a>docker volume create ufdl-pg
</pre>
<p>Run the image as a container:</p>
<pre class="code bash"><a id="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-1" name="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-1" href="#rest_code_99c7b1d4645d416a88552ebf2bdfdb74-1"></a>docker run <span class="se">\</span>
<a id="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-2" name="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-2" href="#rest_code_99c7b1d4645d416a88552ebf2bdfdb74-2"></a> -p <span class="m">5432</span>:5432/tcp <span class="se">\</span>
<a id="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-3" name="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-3" href="#rest_code_99c7b1d4645d416a88552ebf2bdfdb74-3"></a> -v ufdl-pg:/var/lib/postgresql/10/main <span class="se">\</span>
<a id="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-4" name="rest_code_99c7b1d4645d416a88552ebf2bdfdb74-4" href="#rest_code_99c7b1d4645d416a88552ebf2bdfdb74-4"></a> ufdl_postgres
</pre></section><section id="redis"><h4><a class="toc-backref" href="#toc-entry-5" role="doc-backlink">Redis</a></h4>
<p>The backend requires access to a Redis server to enable the use of web-sockets. There is a publically-available image
for a Redis server available:</p>
<pre class="code bash"><a id="rest_code_de63f5c911cd4c03bfdf658825e899a1-1" name="rest_code_de63f5c911cd4c03bfdf658825e899a1-1" href="#rest_code_de63f5c911cd4c03bfdf658825e899a1-1"></a>docker pull public.aml-repo.cms.waikato.ac.nz:443/redis
<a id="rest_code_de63f5c911cd4c03bfdf658825e899a1-2" name="rest_code_de63f5c911cd4c03bfdf658825e899a1-2" href="#rest_code_de63f5c911cd4c03bfdf658825e899a1-2"></a>docker tag public.aml-repo.cms.waikato.ac.nz:443/redis:latest ufdl_redis
</pre>
<p>To run the image, only the port needs exposing:</p>
<pre class="code bash"><a id="rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-1" name="rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-1" href="#rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-1"></a>docker run <span class="se">\</span>
<a id="rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-2" name="rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-2" href="#rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-2"></a> -p <span class="m">6379</span>:6379 <span class="se">\</span>
<a id="rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-3" name="rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-3" href="#rest_code_8e87ba6fe5eb4e6c882d27403f9552b9-3"></a> ufdl_redis
</pre></section><section id="backend"><h4><a class="toc-backref" href="#toc-entry-6" role="doc-backlink">Backend</a></h4>
<p>A Docker image with a preconfigured backend installation is also provided. This image also automatically includes the
HTML client ready-to-go. To obtain the image, with the Docker daemon running:</p>
<pre class="code bash"><a id="rest_code_f3e8fa08c25a434084db5148dccf94d3-1" name="rest_code_f3e8fa08c25a434084db5148dccf94d3-1" href="#rest_code_f3e8fa08c25a434084db5148dccf94d3-1"></a>docker pull public.aml-repo.cms.waikato.ac.nz:443/ufdl/ufdl_backend:latest
<a id="rest_code_f3e8fa08c25a434084db5148dccf94d3-2" name="rest_code_f3e8fa08c25a434084db5148dccf94d3-2" href="#rest_code_f3e8fa08c25a434084db5148dccf94d3-2"></a>docker tag public.aml-repo.cms.waikato.ac.nz:443/ufdl/ufdl_backend:latest ufdl_backend
</pre>
<p>The default environment in this image is set to connect to a database on the Docker <strong>host</strong> (localhost) with
username/password both set to <em>ufdl</em>. You can change these to match your database configuration via the <code class="docutils literal"><span class="pre">--env</span></code>
option to <code class="docutils literal">docker run</code> (below) an providing the environment variables described above, e.g.
<code class="docutils literal"><span class="pre">--env</span> UFDL_POSTGRESQL_HOST=database.example.org</code>.</p>
<p>So that file data will persist between executions, create a volume for storage:</p>
<pre class="code bash"><a id="rest_code_841971cbdc264695b4f4b67e7742b10d-1" name="rest_code_841971cbdc264695b4f4b67e7742b10d-1" href="#rest_code_841971cbdc264695b4f4b67e7742b10d-1"></a>docker volume create ufdl-fs
</pre>
<p>Before you can use the backend for the <strong>first time</strong>, you need to initialise the tables in the database:</p>
<pre class="code bash"><a id="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-1" name="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-1" href="#rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-1"></a>docker run <span class="se">\</span>
<a id="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-2" name="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-2" href="#rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-2"></a> -v ufdl-fs:/ufdl/ufdl-backend/fs <span class="se">\</span>
<a id="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-3" name="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-3" href="#rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-3"></a> --network<span class="o">=</span>host <span class="se">\</span>
<a id="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-4" name="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-4" href="#rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-4"></a> ufdl_backend <span class="se">\</span>
<a id="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-5" name="rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-5" href="#rest_code_8c67b3f31a1e48c9b65fe911c35eb9bb-5"></a> reset
</pre>
<p>From now on. you can start the backend for normal operation as follows:</p>
<pre class="code bash"><a id="rest_code_40e925a1e6364f78b7376514e712c2eb-1" name="rest_code_40e925a1e6364f78b7376514e712c2eb-1" href="#rest_code_40e925a1e6364f78b7376514e712c2eb-1"></a>docker run <span class="se">\</span>
<a id="rest_code_40e925a1e6364f78b7376514e712c2eb-2" name="rest_code_40e925a1e6364f78b7376514e712c2eb-2" href="#rest_code_40e925a1e6364f78b7376514e712c2eb-2"></a> -v ufdl-fs:/ufdl/ufdl-backend/fs <span class="se">\</span>
<a id="rest_code_40e925a1e6364f78b7376514e712c2eb-3" name="rest_code_40e925a1e6364f78b7376514e712c2eb-3" href="#rest_code_40e925a1e6364f78b7376514e712c2eb-3"></a> --network<span class="o">=</span>host <span class="se">\</span>
<a id="rest_code_40e925a1e6364f78b7376514e712c2eb-4" name="rest_code_40e925a1e6364f78b7376514e712c2eb-4" href="#rest_code_40e925a1e6364f78b7376514e712c2eb-4"></a> ufdl_backend
</pre>
<p><strong>NB:</strong> If the backend and the database are both running via Docker on the same machine, a private Docker network can
be created to allow the two services to communicate.</p>
</section></section><section id="initialize"><h3><a class="toc-backref" href="#toc-entry-7" role="doc-backlink">Initialize</a></h3>
<ul class="simple">
<li><p>Download the ZIP file of the <a class="reference external" href="https://adams.cms.waikato.ac.nz/snapshots/ufdl/">ADAMS frontend</a> and unzip it.</p></li>
<li><p>Start ADAMS with the <code class="docutils literal">bin/start_gui.sh</code> script (Linux/Mac) or <code class="docutils literal">bin/start_gui.bat</code> batch file (Windows).</p></li>
<li><p>Use the <em>Flow editor</em> (from the <em>Tools</em> menu) to run the <code class="docutils literal"><span class="pre">adams-ufdl-all-basic_setup.flow</span></code> flow for setting up a
basic environment (users, teams, projects).</p></li>
</ul></section><section id="worker-node"><h3><a class="toc-backref" href="#toc-entry-8" role="doc-backlink">Worker node</a></h3>
<p>A Docker image with a preconfigured worker node installation is also provided. To obtain the image, with the Docker
daemon running:</p>
<pre class="code bash"><a id="rest_code_45b8f89451034920a91a05f9e28c0d93-1" name="rest_code_45b8f89451034920a91a05f9e28c0d93-1" href="#rest_code_45b8f89451034920a91a05f9e28c0d93-1"></a>docker pull public.aml-repo.cms.waikato.ac.nz:443/ufdl/ufdl_job_launcher:latest
<a id="rest_code_45b8f89451034920a91a05f9e28c0d93-2" name="rest_code_45b8f89451034920a91a05f9e28c0d93-2" href="#rest_code_45b8f89451034920a91a05f9e28c0d93-2"></a>docker tag public.aml-repo.cms.waikato.ac.nz:443/ufdl/ufdl_job_launcher:latest ufdl_job_launcher
</pre>
<p>Download the <a class="reference external" href="https://raw.githubusercontent.com/waikato-ufdl/ufdl-job-launcher/master/examples/job-launcher-docker.conf">job-launcher-docker.conf</a>
template and save it as something like <code class="docutils literal"><span class="pre">/path/to/job-launcher.conf</span></code> (you can adjust this path, of course).
Then you can launch the worker node as follows:</p>
<pre class="code bash"><a id="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-1" name="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-1" href="#rest_code_d59dbacd0c9c4b188704731dd2ceb70c-1"></a>docker run <span class="se">\</span>
<a id="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-2" name="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-2" href="#rest_code_d59dbacd0c9c4b188704731dd2ceb70c-2"></a> -v /var/run/docker.sock:/var/run/docker.sock <span class="se">\</span>
<a id="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-3" name="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-3" href="#rest_code_d59dbacd0c9c4b188704731dd2ceb70c-3"></a> -v /path/to/job-launcher.conf:/ufdl/ufdl-job-launcher/examples/job-launcher-example.conf <span class="se">\</span>
<a id="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-4" name="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-4" href="#rest_code_d59dbacd0c9c4b188704731dd2ceb70c-4"></a> -v /tmp/ufdl-job-launcher:/tmp/ufdl-job-launcher <span class="se">\</span>
<a id="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-5" name="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-5" href="#rest_code_d59dbacd0c9c4b188704731dd2ceb70c-5"></a> --network<span class="o">=</span>host <span class="se">\</span>
<a id="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-6" name="rest_code_d59dbacd0c9c4b188704731dd2ceb70c-6" href="#rest_code_d59dbacd0c9c4b188704731dd2ceb70c-6"></a> ufdl_job_launcher
</pre>
<p><strong>NB:</strong></p>
<ul class="simple">
<li><p>If the backend and the database are both running via Docker on the same machine, a private Docker network can be created to allow the two services to communicate.</p></li>
<li>
<p>Since you are supplying the job launcher configuration to the docker container, make sure that the following directories are set to these values:</p>
<ul>
<li><p><code class="docutils literal">work_dir</code>: <code class="docutils literal"><span class="pre">/tmp/ufdl-job-launcher</span></code></p></li>
<li><p><code class="docutils literal">cache_dir</code>: <code class="docutils literal"><span class="pre">/tmp/ufdl-job-launcher/cache</span></code></p></li>
</ul>
</li>
</ul></section></section><section id="manual-setup"><h2><a class="toc-backref" href="#toc-entry-9" role="doc-backlink">Manual setup</a></h2>
<section id="postgresql-1"><h3><a class="toc-backref" href="#toc-entry-10" role="doc-backlink">PostgreSQL</a></h3>
<p>Make sure you have PostgreSQL installed and the server is running, and then add a database for the backend
to use (e.g. by using psql -c COMMAND postgres) (<strong>N.B.</strong> the database name must be <em>ufdl</em>):</p>
<pre class="code sql"><a id="rest_code_6aa203e8743d4d7a82b1e09015f32e31-1" name="rest_code_6aa203e8743d4d7a82b1e09015f32e31-1" href="#rest_code_6aa203e8743d4d7a82b1e09015f32e31-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">ufdl</span><span class="p">;</span><span class="w"></span>
</pre>
<p>Create a user for the backend to access the database with (replace the username/password with whatever you like):</p>
<pre class="code sql"><a id="rest_code_10ab8c484b814f4f814a982c41c9ab40-1" name="rest_code_10ab8c484b814f4f814a982c41c9ab40-1" href="#rest_code_10ab8c484b814f4f814a982c41c9ab40-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="k">ENCRYPTED</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">'password'</span><span class="p">;</span><span class="w"></span>
<a id="rest_code_10ab8c484b814f4f814a982c41c9ab40-2" name="rest_code_10ab8c484b814f4f814a982c41c9ab40-2" href="#rest_code_10ab8c484b814f4f814a982c41c9ab40-2"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">ufdl</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">username</span><span class="p">;</span><span class="w"></span>
</pre>
<p>Edit the Host-Based Authentication file for PostgreSQL (usually located at /etc/postgresql/{VERSION}/main/pg_hba.conf)
to allow the user to authenticate with the database. If the backend server will be running on the same machine as the
database, run:</p>
<pre class="code bash"><a id="rest_code_6e3df5db30ea48c3871f9251a1c76d32-1" name="rest_code_6e3df5db30ea48c3871f9251a1c76d32-1" href="#rest_code_6e3df5db30ea48c3871f9251a1c76d32-1"></a><span class="nb">echo</span> <span class="s2">"local ufdl username md5"</span> &gt;&gt; /path/to/pg_hba.conf
</pre>
<p>otherwise:</p>
<pre class="code bash"><a id="rest_code_a500def327e444bfacde2b560fa856b6-1" name="rest_code_a500def327e444bfacde2b560fa856b6-1" href="#rest_code_a500def327e444bfacde2b560fa856b6-1"></a><span class="nb">echo</span> <span class="s2">"host ufdl username all md5"</span> &gt;&gt; /path/to/pg_hba.conf
</pre>
<p>If the backend will not be running on the same machine as the database, the 'listen_addresses' setting in
postgresql.conf also needs to be set to allow the backend to connect (e.g. by setting it to '*').</p>
</section><section id="backend-1"><h3><a class="toc-backref" href="#toc-entry-11" role="doc-backlink">Backend</a></h3>
<p>The backend requires Redis to support web-socket connections to the server. Make sure a Redis server is installed
and running on the backend host.</p>
<p>Then, clone the following repositories (within the same directory):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/waikato-ufdl/ufdl-backend">ufdl-backend</a></p></li>
<li><p><a class="reference external" href="https://github.com/waikato-ufdl/ufdl-json-messages">ufdl-json-messages</a></p></li>
</ul>
<pre class="code bash"><a id="rest_code_403d73ec015247babc693f71b51c0bb2-1" name="rest_code_403d73ec015247babc693f71b51c0bb2-1" href="#rest_code_403d73ec015247babc693f71b51c0bb2-1"></a>git clone https://github.com/waikato-ufdl/ufdl-backend
<a id="rest_code_403d73ec015247babc693f71b51c0bb2-2" name="rest_code_403d73ec015247babc693f71b51c0bb2-2" href="#rest_code_403d73ec015247babc693f71b51c0bb2-2"></a>git clone https://github.com/waikato-ufdl/ufdl-json-messages
</pre>
<p>The backend requires instruction on how to connect to the PostgreSQL database, which is provided through environment
variables:</p>
<pre class="code bash"><a id="rest_code_97af916e7eb04fffab2945237541161a-1" name="rest_code_97af916e7eb04fffab2945237541161a-1" href="#rest_code_97af916e7eb04fffab2945237541161a-1"></a><span class="nb">export</span> <span class="nv">UFDL_POSTGRESQL_USER</span><span class="o">=</span>username
<a id="rest_code_97af916e7eb04fffab2945237541161a-2" name="rest_code_97af916e7eb04fffab2945237541161a-2" href="#rest_code_97af916e7eb04fffab2945237541161a-2"></a><span class="nb">export</span> <span class="nv">UFDL_POSTGRESQL_PASSWORD</span><span class="o">=</span>password
<a id="rest_code_97af916e7eb04fffab2945237541161a-3" name="rest_code_97af916e7eb04fffab2945237541161a-3" href="#rest_code_97af916e7eb04fffab2945237541161a-3"></a><span class="nb">export</span> <span class="nv">UFDL_POSTGRESQL_HOST</span><span class="o">=</span>host.domain.name:port
</pre>
<p>The host defaults to <em>localhost</em> and the user to <em>ufdl</em>, so if these match your database configuration they need not
be supplied. The password has not default though and must be supplied.</p>
<p>Change into the directory of the cloned <em>ufdl-backend</em> repository and run the following script to set up
the virtual environment for the server (<strong>CAUTION:</strong> it will delete any previously stored data and the database):</p>
<pre class="code bash"><a id="rest_code_581238eae21c413c8e57c2a8080b0008-1" name="rest_code_581238eae21c413c8e57c2a8080b0008-1" href="#rest_code_581238eae21c413c8e57c2a8080b0008-1"></a>./dev_init.sh
</pre>
<p><strong>NB:</strong> <em>dev_init.sh</em> creates an admin user with username/password set to admin/admin respectively.</p>
<p>Once this has completed, you can start up the REST API on <code class="docutils literal">127.0.0.1</code> as follows:</p>
<pre class="code bash"><a id="rest_code_4578bca048994ea1b88b9f84609fe4a3-1" name="rest_code_4578bca048994ea1b88b9f84609fe4a3-1" href="#rest_code_4578bca048994ea1b88b9f84609fe4a3-1"></a>./dev_start.sh
</pre>
<p>Use <code class="docutils literal">0.0.0.0:8000</code> as argument if you want to make the server available to the outside world on port 8000.
Ensure that your firewall allows that port to be accessed from the outside.</p>
</section><section id="html-front-end-optional"><h3><a class="toc-backref" href="#toc-entry-12" role="doc-backlink">HTML front-end (optional)</a></h3>
<p>If you wish to use the HTML front-end with the UFDL system, it can be built and installed into the backend to be
served as a single-page application. Ensure you have Node installed, and then clone the required repositories
(within the same directory):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/waikato-ufdl/ufdl-ts-client">ufdl-ts-client</a></p></li>
<li><p><a class="reference external" href="https://github.com/waikato-ufdl/ufdl-frontend-ts">ufdl-frontend-ts</a></p></li>
</ul>
<pre class="code bash"><a id="rest_code_49bd9c5f9fcf4c948b298b96c9b184d9-1" name="rest_code_49bd9c5f9fcf4c948b298b96c9b184d9-1" href="#rest_code_49bd9c5f9fcf4c948b298b96c9b184d9-1"></a>git clone https://github.com/waikato-ufdl/ufdl-ts-client
<a id="rest_code_49bd9c5f9fcf4c948b298b96c9b184d9-2" name="rest_code_49bd9c5f9fcf4c948b298b96c9b184d9-2" href="#rest_code_49bd9c5f9fcf4c948b298b96c9b184d9-2"></a>git clone https://github.com/waikato-ufdl/ufdl-frontend-ts
</pre>
<p>Build the client library:</p>
<pre class="code bash"><a id="rest_code_ba6e11ab20864631b29ee50b8de39c2c-1" name="rest_code_ba6e11ab20864631b29ee50b8de39c2c-1" href="#rest_code_ba6e11ab20864631b29ee50b8de39c2c-1"></a><span class="nb">cd</span> ufdl-ts-client
<a id="rest_code_ba6e11ab20864631b29ee50b8de39c2c-2" name="rest_code_ba6e11ab20864631b29ee50b8de39c2c-2" href="#rest_code_ba6e11ab20864631b29ee50b8de39c2c-2"></a>npm install .
<a id="rest_code_ba6e11ab20864631b29ee50b8de39c2c-3" name="rest_code_ba6e11ab20864631b29ee50b8de39c2c-3" href="#rest_code_ba6e11ab20864631b29ee50b8de39c2c-3"></a>npm run rebuild
</pre>
<p>Build the front-end:</p>
<pre class="code bash"><a id="rest_code_87a6fc8260a244cf87f5d4daf0e79b14-1" name="rest_code_87a6fc8260a244cf87f5d4daf0e79b14-1" href="#rest_code_87a6fc8260a244cf87f5d4daf0e79b14-1"></a><span class="nb">cd</span> ../ufdl-frontend-ts
<a id="rest_code_87a6fc8260a244cf87f5d4daf0e79b14-2" name="rest_code_87a6fc8260a244cf87f5d4daf0e79b14-2" href="#rest_code_87a6fc8260a244cf87f5d4daf0e79b14-2"></a>npm install .
<a id="rest_code_87a6fc8260a244cf87f5d4daf0e79b14-3" name="rest_code_87a6fc8260a244cf87f5d4daf0e79b14-3" href="#rest_code_87a6fc8260a244cf87f5d4daf0e79b14-3"></a>npm run rebuild
</pre>
<p>Copy the built front-end into the backend for serving:</p>
<pre class="code bash"><a id="rest_code_32f6d4cb2e6348c5a7f6655cc1a47f89-1" name="rest_code_32f6d4cb2e6348c5a7f6655cc1a47f89-1" href="#rest_code_32f6d4cb2e6348c5a7f6655cc1a47f89-1"></a>cp -rf build /path/to/backend/venv.dev/lib/python3.7/site-packages/ufdl/html_client_app/static
</pre>
<p>The source clones for the client and front-end are no longer needed at this stage and can be safely deleted.</p>
</section><section id="initialize-1"><h3><a class="toc-backref" href="#toc-entry-13" role="doc-backlink">Initialize</a></h3>
<ul class="simple">
<li><p>Download the ZIP file of the <a class="reference external" href="https://adams.cms.waikato.ac.nz/snapshots/ufdl/">ADAMS frontend</a> and unzip it.</p></li>
<li><p>Start ADAMS with the <code class="docutils literal">bin/start_gui.sh</code> script (Linux/Mac) or <code class="docutils literal">bin/start_gui.bat</code> batch file (Windows).</p></li>
<li><p>Use the <em>Flow editor</em> (from the <em>Tools</em> menu) to run the <code class="docutils literal"><span class="pre">adams-ufdl-all-basic_setup.flow</span></code> flow for setting up a
basic environment (users, teams, projects).</p></li>
</ul></section><section id="worker-node-1"><h3><a class="toc-backref" href="#toc-entry-14" role="doc-backlink">Worker node</a></h3>
<p>On the worker node, clone the following repositories (within the same directory):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/waikato-ufdl/ufdl-json-messages">ufdl-json-messages</a></p></li>
<li><p><a class="reference external" href="https://github.com/waikato-ufdl/ufdl-python-client">ufdl-python-client</a></p></li>
<li><p><a class="reference external" href="https://github.com/waikato-ufdl/ufdl-job-launcher">ufdl-job-launcher</a></p></li>
</ul>
<pre class="code bash"><a id="rest_code_950cf497bf2e4e79a5eef428df83c7d4-1" name="rest_code_950cf497bf2e4e79a5eef428df83c7d4-1" href="#rest_code_950cf497bf2e4e79a5eef428df83c7d4-1"></a>git clone https://github.com/waikato-ufdl/ufdl-json-messages
<a id="rest_code_950cf497bf2e4e79a5eef428df83c7d4-2" name="rest_code_950cf497bf2e4e79a5eef428df83c7d4-2" href="#rest_code_950cf497bf2e4e79a5eef428df83c7d4-2"></a>git clone https://github.com/waikato-ufdl/ufdl-python-client
<a id="rest_code_950cf497bf2e4e79a5eef428df83c7d4-3" name="rest_code_950cf497bf2e4e79a5eef428df83c7d4-3" href="#rest_code_950cf497bf2e4e79a5eef428df83c7d4-3"></a>git clone https://github.com/waikato-ufdl/ufdl-job-launcher
</pre>
<p>Change into the directory of the cloned <em>ufdl-job-launcher</em> repository and run the following script to set up
the virtual environment:</p>
<pre class="code bash"><a id="rest_code_494dda7abcb34cf48da0a1ddbd833595-1" name="rest_code_494dda7abcb34cf48da0a1ddbd833595-1" href="#rest_code_494dda7abcb34cf48da0a1ddbd833595-1"></a>./dev_init.sh
</pre>
<p>In the <code class="docutils literal">examples</code> directory, you can copy the <code class="docutils literal"><span class="pre">job-launcher-example.conf</span></code> configuration to <code class="docutils literal"><span class="pre">job-launcher.conf</span></code>
and then update the required parameters (if anything, should be only the <code class="docutils literal">url</code>).</p>
<p>Once this suits your system, you can start the job-launcher like this (from within the <code class="docutils literal"><span class="pre">ufdl-job-launcher</span></code> directory):</p>
<pre class="code bash"><a id="rest_code_fdf4cef0c46745c2963f1168e739bcf7-1" name="rest_code_fdf4cef0c46745c2963f1168e739bcf7-1" href="#rest_code_fdf4cef0c46745c2963f1168e739bcf7-1"></a>./venv.dev/bin/ufdl-joblauncher -C examples/job-launcher.conf -C
</pre></section></section><section id="use-the-system"><h2><a class="toc-backref" href="#toc-entry-15" role="doc-backlink">Use the system</a></h2>
<section id="adams"><h3><a class="toc-backref" href="#toc-entry-16" role="doc-backlink">ADAMS</a></h3>
<p>The following ADAMS flows are available to manage your datasets and run jobs (simply execute them with the <em>Flow editor</em>):</p>
<ul class="simple">
<li><p><code class="docutils literal"><span class="pre">adams-ufdl-core-manage_backend.flow</span></code> - for managing the backend, starting jobs, etc.</p></li>
<li><p><code class="docutils literal"><span class="pre">adams-ufdl-image-manage_image_classification_datasets.flow</span></code> - manages image classification datasets</p></li>
<li><p><code class="docutils literal"><span class="pre">adams-ufdl-image-manage_objected_detection_datasets.flow</span></code> - manages object detection datasets</p></li>
<li><p><code class="docutils literal"><span class="pre">adams-ufdl-speech-manage_speech_datasets.flow</span></code> - manages speech datasets</p></li>
</ul></section><section id="html-frontend"><h3><a class="toc-backref" href="#toc-entry-17" role="doc-backlink">HTML Frontend</a></h3>
<p>Some of the functionality is available through a web-based frontend.
By default, the interface is being served on the following URL:</p>
<p><a class="reference external" href="http://localhost:8000/v1/html">http://localhost:8000/v1/html</a></p>
</section></section>
</div>
    

</article><!--End of body content--><footer id="footer">
            Contents Â© 2019-2022         <a href="mailto:fracpete@waikato.ac.nz">University of Waikato</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
